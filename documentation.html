<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBI Fraud Detection - Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f6fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navbar Styles */
        .navbar {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            height: 30px;
            margin-right:10px;
        }

        .logo span {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .nav-items {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
            margin-right: 20px;
        }

        .nav-links li a, .dropdown-toggle {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            cursor: pointer;
        }

        .nav-links li a:hover, .dropdown-toggle:hover {
            color: #2e7dff;
        }

        .dropdown {
            position: relative;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #fff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            padding: 10px 0;
            min-width: 180px;
            display: none;
            z-index: 1;
        }

        .dropdown-menu li {
            list-style: none;
        }

        .dropdown-menu li a {
            display: block;
            padding: 8px 20px;
            color: #333;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        .dropdown-menu li a:hover {
            background-color: #f5f5f5;
            color: #2e7dff;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        /* Documentation Page Styles */
        .doc-header {
            background-color: #5255CA;
            background-color:#000066;
            color: white;
            padding: 60px 0;
            text-align: center;
            margin-bottom: 40px;
        }

        .doc-header h1 {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .doc-header p {
            font-size: 18px;
            max-width: 800px;
            margin: 0 auto;
        }

        .doc-content {
            padding: 30px 0 60px;
        }

        .doc-nav {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .doc-nav ul {
            display: flex;
            list-style: none;
            gap: 15px;
            flex-wrap: wrap;
        }

        .doc-nav ul li a {
            text-decoration: none;
            color: #2e7dff;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .doc-nav ul li a:hover {
            background-color: #f0f7ff;
        }

        .doc-section {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .doc-section h2 {
            color: #2e7dff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .doc-section h3 {
            color: #333;
            margin: 25px 0 15px;
        }

        .doc-section p {
            margin-bottom: 15px;
        }

        .doc-section ul, .doc-section ol {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .doc-section li {
            margin-bottom: 8px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background-color: #f8faff;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card i {
            font-size: 32px;
            color: #2e7dff;
            margin-bottom: 15px;
        }

        .feature-card h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2e7dff;
        }

        .step-box {
            background-color: #f0f7ff;
            border-left: 4px solid #2e7dff;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
        }

        .step-box h4 {
            color: #2e7dff;
            margin-bottom: 10px;
        }

        .code-block {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            overflow-x: auto;
            margin-bottom: 20px;
        }

        .image-container {
            text-align: center;
            margin: 20px 0;
        }

        .image-container img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .note-box {
            background-color: #fff9e6;
            border-left: 4px solid #ffd700;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .note-box p {
            margin: 0;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        table tr:hover {
            background-color: #f8faff;
        }

        .faq-item {
            margin-bottom: 20px;
        }

        .faq-question {
            font-weight: 600;
            color: #2e7dff;
            margin-bottom: 10px;
        }

        .faq-answer {
            padding-left: 15px;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #2e7dff;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            opacity: 0;
            visibility: hidden;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background-color: #1b5e20;
            transform: translateY(-3px);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .doc-header {
                padding: 40px 0;
            }

            .doc-header h1 {
                font-size: 28px;
            }

            .doc-section {
                padding: 20px;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <header class="navbar">
        <div class="container nav-container">
            <div class="logo">
                <img src="sbi_logo.png" alt="SBI Logo">
                <span>Life Insurance</span>
            </div>
            <div class="nav-items">
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="documentation.html">Documentation</a></li>
                    <div class="dropdown">
                        <a id="dropdownBtn" class="dropdown-toggle">Detection</a>
                        <ul class="dropdown-menu" id="dropdownMenu">
                            <li><a href="manualEntry.html">Manual Data Entry</a></li>
                            <li><a href="bulkUpload.html">Bulk Upload</a></li>
                            <li><a href="signAuth.html">E-SignAuth</a></li>
                        </ul>
                    </div>
                    <li><a href="https://fraud-analysis.onrender.com/">Analysis</a></li>
                </ul>
                <button class="signin-btn" id="signInBtn">Log In</button>
                <style>
                    .signin-btn {
                        background-color: #2e7dff;
                        color: #fff;
                        padding: 10px 20px;
                        border: none;
                        border-radius: 6px;
                        text-decoration: none;
                        font-size: 16px;
                        cursor: pointer;
                    }
                    .signin-btn:hover {
                        background-color: #1b5e20;
                    }
                </style>
            </div>
        </div>
    </header>

    <!-- Documentation Header -->
    <div class="doc-header">
        <div class="container">
            <h1>SBI Fraud Detection and Prevention System</h1>
            <p>Comprehensive documentation for leveraging SBI's advanced fraud detection tools and analytics platform</p>
        </div>
    </div>

    <!-- Documentation Content -->
    <div class="container">
        <div class="doc-content">
            <!-- Quick Navigation -->
            <div class="doc-nav">
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#manual-entry">Manual Data Entry</a></li>
                    <li><a href="#bulk-upload">Bulk Upload</a></li>
                    <li><a href="#signature-auth">Signature Authentication</a></li>
                    <li><a href="#analysis-dashboard">Analysis Dashboard</a></li>
                    <li><a href="#faq">FAQ</a></li>
                </ul>
            </div>

            <!-- Overview Section -->
            <div class="doc-section" id="overview">
                <h2>System Overview</h2>
                <p>The SBI Fraud Detection and Prevention System is an advanced platform designed to identify, prevent, and analyze fraudulent activities within SBI Life Insurance operations. The system employs cutting-edge algorithms and validation techniques to ensure the integrity of insurance claims and applications.</p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <i class="fas fa-edit"></i>
                        <h3>Manual Data Entry</h3>
                        <p>Validate individual entries through a comprehensive form-based process with real-time validation checks.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-file-upload"></i>
                        <h3>Bulk Upload</h3>
                        <p>Process multiple records simultaneously through file uploads with detailed validation reporting.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-fingerprint"></i>
                        <h3>E-SignAuth</h3>
                        <p>Verify signature authenticity using advanced image processing and comparison algorithms.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h3>Analysis Dashboard</h3>
                        <p>Comprehensive visual analytics for monitoring fraud patterns, trends, and risk assessments.</p>
                    </div>
                </div>

                <h3>System Requirements</h3>
                <ul>
                    <li>Web browser: Chrome (version 90+), Firefox (version 88+), Safari (version 14+), or Edge (version 90+)</li>
                    <li>Screen resolution: Minimum 1280Ã—800</li>
                    <li>Internet connection: 1 Mbps or faster</li>
                    <li>Required permissions: Access granted by SBI system administrator</li>
                </ul>

                <div class="note-box">
                    <p><strong>Note:</strong> Access to specific features may vary based on user role and permissions assigned by your organization's administrator.</p>
                </div>
            </div>

            <!-- Manual Data Entry Section -->
            <div class="doc-section" id="manual-entry">
                <h2>Manual Data Entry</h2>
                <p>The Manual Data Entry module allows authorized users to input individual client information and transaction details for fraud detection analysis. The system provides real-time validation and risk assessment as data is entered.</p>

                <h3>Key Features</h3>
                <ul>
                    <li>Real-time data validation against known fraud patterns</li>
                    <li>ID verification using government databases</li>
                    <li>Address and contact information validation</li>
                    <li>Transaction history analysis</li>
                    <li>Duplicate entry detection</li>
                    <li>Risk score calculation</li>
                </ul>

                <h3>How to Use Manual Data Entry</h3>
                <div class="step-box">
                    <h4>Step 1: Access the Manual Entry Form</h4>
                    <p>Navigate to the Detection dropdown in the main navigation and select "Manual Data Entry" or click directly on the link in the sidebar.</p>
                </div>

                <div class="step-box">
                    <h4>Step 2: Complete the Required Fields</h4>
                    <p>Fill in all mandatory fields marked with an asterisk (*). The form includes sections for personal information, policy details, claim information, and supporting documentation.</p>
                </div>

                <div class="step-box">
                    <h4>Step 3: Review Validation Results</h4>
                    <p>After submission, the system will display validation results, including a risk score and any detected anomalies or warnings.</p>
                </div>

                <div class="step-box">
                    <h4>Step 4: Take Appropriate Action</h4>
                    <p>Based on the validation results, follow the recommended actions provided by the system (approve, investigate further, or reject).</p>
                </div>

                <div class="image-container">
                    <img src="image.png" alt="Manual Data Entry Form Interface">
                </div>

                <h3>Field Descriptions</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Field Name</th>
                                <th>Description</th>
                                <th>Validation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Policy Number</td>
                                <td>Unique SBI Life Insurance policy identifier</td>
                                <td>Must match existing policy format (SBIL-XXXXXXXX)</td>
                            </tr>
                            <tr>
                                <td>Policyholder Name</td>
                                <td>Full legal name of the policyholder</td>
                                <td>Alphabetic characters only</td>
                            </tr>
                            <tr>
                                <td>ID Type</td>
                                <td>Government-issued identification type</td>
                                <td>Must select from dropdown (Aadhaar, PAN, Passport, etc.)</td>
                            </tr>
                            <tr>
                                <td>ID Number</td>
                                <td>Corresponding ID number</td>
                                <td>Format validation based on ID type</td>
                            </tr>
                            <tr>
                                <td>Contact Number</td>
                                <td>Primary contact number</td>
                                <td>10-digit mobile number validation</td>
                            </tr>
                            <tr>
                                <td>Email Address</td>
                                <td>Primary email contact</td>
                                <td>Standard email format validation</td>
                            </tr>
                            <tr>
                                <td>Claim Amount</td>
                                <td>Requested payout amount</td>
                                <td>Numeric value within policy limits</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Bulk Upload Section -->
            <div class="doc-section" id="bulk-upload">
                <h2>Bulk Upload</h2>
                <p>The Bulk Upload functionality enables processing multiple records simultaneously, significantly improving efficiency for batch operations and regular reporting needs.</p>

                <h3>Supported File Formats</h3>
                <ul>
                    <li><strong>CSV</strong> - Comma-separated values format</li>
                    <li><strong>XLSX</strong> - Microsoft Excel format</li>
                    <li><strong>XML</strong> - Extensible Markup Language format</li>
                </ul>

                <h3>Upload Process</h3>
                <div class="step-box">
                    <h4>Step 1: Prepare Your Data File</h4>
                    <p>Ensure your file matches the required template format. Templates can be downloaded from the Bulk Upload page.</p>
                </div>

                <div class="step-box">
                    <h4>Step 2: Upload the File</h4>
                    <p>Click the "Choose File" button, select your prepared file, and click "Upload" to initiate processing.</p>
                </div>

                <div class="step-box">
                    <h4>Step 3: Validation and Processing</h4>
                    <p>The system will validate all records and display a progress indicator. Large files may take several minutes to process.</p>
                </div>

                <div class="step-box">
                    <h4>Step 4: Review Results</h4>
                    <p>Once processing is complete, a summary report will be displayed, showing successful entries, warnings, and errors.</p>
                </div>

                <div class="image-container">
                    <img src="image2.png" alt="Bulk Upload Interface with Results">
                </div>

                <h3>Template Structure</h3>
                <p>Below is an example of the CSV file structure required for bulk uploads:</p>
                <div class="code-block">
                    Policy_Number,Holder_Name,ID_Type,ID_Number,Contact_Number,Email,Claim_Amount,Claim_Date<br>
                    SBIL-12345678,Rajesh Kumar,Aadhaar,123456789012,9876543210,rajesh@example.com,250000,2023-04-15<br>
                    SBIL-87654321,Priya Sharma,PAN,ABCDE1234F,8765432109,priya@example.com,500000,2023-04-16
                </div>

                <div class="note-box">
                    <p><strong>Important:</strong> The maximum file size for upload is 10MB. For larger datasets, please split your files or contact the system administrator.</p>
                </div>

                <h3>Error Handling</h3>
                <p>The system provides detailed error reports for invalid entries. Common errors include:</p>
                <ul>
                    <li>Missing required fields</li>
                    <li>Invalid format (e.g., incorrect ID number format)</li>
                    <li>Duplicate entries</li>
                    <li>Non-existent policy numbers</li>
                    <li>Suspicious patterns requiring manual review</li>
                </ul>
            </div>

            <!-- Signature Authentication Section -->
            <div class="doc-section" id="signature-auth">
                <h2>Signature Authentication</h2>
                <p>The E-SignAuth module provides advanced signature verification capabilities, comparing submitted signatures against reference signatures on file to detect potential forgeries and unauthorized transactions.</p>

                <h3>Key Features</h3>
                <ul>
                    <li>High-precision image processing algorithms</li>
                    <li>Multiple signature comparison methods</li>
                    <li>Confidence scoring system</li>
                    <li>Detailed analysis reports</li>
                    <li>Historical verification audit trail</li>
                </ul>

                <h3>Verification Process</h3>
                <div class="step-box">
                    <h4>Step 1: Access E-SignAuth</h4>
                    <p>Navigate to the Detection dropdown in the main navigation and select "E-SignAuth".</p>
                </div>

                <div class="step-box">
                    <h4>Step 2: Upload Signatures</h4>
                    <p>Upload the signature to be verified (in JPG, PNG, or TIFF format) and enter the policy number to retrieve the reference signature.</p>
                </div>

                <div class="step-box">
                    <h4>Step 3: Review Comparison Results</h4>
                    <p>The system will display both signatures side by side with a detailed analysis and a confidence score.</p>
                </div>

                <div class="step-box">
                    <h4>Step 4: Make a Decision</h4>
                    <p>Based on the confidence score and visual comparison, make a determination about the signature's authenticity.</p>
                </div>

                <div class="image-container">
                    <img src="image3.png" alt="Signature Verification Interface">
                </div>

                <h3>Confidence Score Interpretation</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Score Range</th>
                                <th>Interpretation</th>
                                <th>Recommended Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>90-100%</td>
                                <td>Very high confidence match</td>
                                <td>Proceed with transaction</td>
                            </tr>
                            <tr>
                                <td>75-89%</td>
                                <td>High confidence match</td>
                                <td>Proceed with standard verification</td>
                            </tr>
                            <tr>
                                <td>60-74%</td>
                                <td>Moderate confidence</td>
                                <td>Additional verification recommended</td>
                            </tr>
                            <tr>
                                <td>40-59%</td>
                                <td>Low confidence</td>
                                <td>Manual review required</td>
                            </tr>
                            <tr>
                                <td>Below 40%</td>
                                <td>Very low confidence / Likely mismatch</td>
                                <td>Reject and investigate</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="note-box">
                    <p><strong>Note:</strong> For optimal results, ensure uploaded signatures are clear, properly scanned at 300 DPI or higher, and not cropped too closely to the signature edges.</p>
                </div>
            </div>

            <!-- Analysis Dashboard Section -->
            <div class="doc-section" id="analysis-dashboard">
                <h2>Analysis Dashboard</h2>
                <p>The Analysis Dashboard provides comprehensive visual analytics to help identify fraud patterns, track detection metrics, and generate detailed reports for monitoring and compliance purposes.</p>

                <h3>Dashboard Components</h3>
                <ul>
                    <li><strong>Fraud Detection Summary</strong> - Key performance indicators and detection statistics</li>
                    <li><strong>Trend Analysis</strong> - Graphical representation of fraud attempt patterns over time</li>
                    <li><strong>Geographic Distribution</strong> - Heat maps showing fraud activity by region</li>
                    <li><strong>Risk Category Breakdown</strong> - Pie charts showing distribution of fraud types</li>
                    <li><strong>Real-time Alerts</strong> - Notifications for high-risk activities requiring immediate attention</li>
                </ul>

                <div class="image-container">
                    <img src="dashboard.png" alt="Analysis Dashboard Overview">
                </div>

                <h3>Available Charts and Visualizations</h3>
                <div class="feature-grid">
                    <div class="feature-card">
                        <i class="fas fa-chart-line"></i>
                        <h3>Trend Lines</h3>
                        <p>Track fraud detection metrics over time with interactive time series visualizations.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-chart-pie"></i>
                        <h3>Distribution Charts</h3>
                        <p>Analyze the breakdown of fraud types, risk levels, and detection methods.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-map-marked-alt"></i>
                        <h3>Geographic Maps</h3>
                        <p>Visualize geographic distribution of fraud attempts across regions.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-table"></i>
                        <h3>Data Tables</h3>
                        <p>Detailed, searchable, and sortable tables of fraud detection records.</p>
                    </div>
                </div>

                <h3>Report Generation</h3>
                <p>The dashboard allows for customized report generation based on selected filters and parameters:</p>
                <ul>
                    <li>Date range selection</li>
                    <li>Department or branch filtering</li>
                    <li>Risk level categorization</li>
                    <li>Detection method filtering</li>
                    <li>Export formats: PDF, XLSX, CSV</li>
                </ul>

                <h3>Dashboard Customization</h3>
                <p>Users can personalize their dashboard view by:</p>
                <ul>
                    <li>Rearranging widgets via drag-and-drop</li>
                    <li>Setting default date ranges and filters</li>
                    <li>Creating saved views for frequently accessed reports</li>
                    <li>Configuring alert thresholds and notification preferences</li>
                </ul>

                <div class="note-box">
                    <p><strong>Tip:</strong> For optimal performance when viewing complex dashboard visualizations, use a widescreen monitor and ensure your browser is updated to the latest version.</p>
                </div>
            </div>

            <!-- FAQ Section -->
            <div class="doc-section" id="faq">
                <h2>Frequently Asked Questions</h2>
                
                <div class="faq-item">
                    <div class="faq-question">Q: How often is the fraud detection system updated with new patterns?</div>
                    <div class="faq-answer">A: The system's fraud detection algorithms and pattern recognition models are updated bi-weekly. Critical updates for newly identified fraud schemes may be deployed more frequently as needed.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: What should I do if the system flags a transaction that I believe is legitimate?</div>
                    <div class="faq-answer">A: If you believe a flagged transaction is legitimate, use the "Review Case" function to document your assessment and supporting evidence. Each case is then reviewed by a senior fraud analyst before final determination.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: Can I schedule automated bulk uploads?</div>
                    <div class="faq-answer">A: Yes, scheduled bulk uploads can be configured from the Administration section. You can set daily, weekly, or monthly schedules and specify the file location for automatic processing.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: How accurate is the signature verification system?</div>
                    <div class="faq-answer">A: The signature verification system has a proven accuracy rate of 96.7% when provided with clear signature samples. Accuracy may vary depending on signature clarity and consistency.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: Can I export dashboard data for external analysis?</div>
                    <div class="faq-answer">A: Yes, all dashboard visualizations can be exported in various formats (PNG, PDF) and the underlying data can be exported as CSV or XLSX files for further analysis in external tools.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: What security measures are in place to protect the data?</div>
                    <div class="faq-answer">A: The system employs bank-grade security including 256-bit encryption, multi-factor authentication, role-based access controls, comprehensive audit logs, and secure data centers compliant with ISO 27001 standards.</div>
<!-- Add this JavaScript before the closing body tag -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get chatbot elements
      const chatbotIcon = document.getElementById('chatbotIcon');
      const chatbotInterface = document.getElementById('chatbotInterface');
      const closeChatbot = document.getElementById('closeChatbot');
      const userInput = document.getElementById('userInput');
      const sendMessage = document.getElementById('sendMessage');
      const chatbotMessages = document.getElementById('chatbotMessages');
      const notificationBadge = document.getElementById('notificationBadge');
      const chatbotLoading = document.getElementById('chatbotLoading');
      const fullscreenButton = document.getElementById('fullscreenButton');
      
      // Backend API URLs
      const API_BASE_URL = 'http://127.0.0.1:5000';  // Adjust this to your backend URL if deployed
      
      // Store session ID
      let sessionId = '';
      
      // Initialize chat session when chatbot is first opened
      async function initChatSession() {
        try {
          const response = await fetch(`${API_BASE_URL}/chat/start`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            }
          });
          
          if (!response.ok) {
            throw new Error('Failed to initialize chat session');
          }
          
          const data = await response.json();
          sessionId = data.session_id;
          console.log('Chat session initialized with ID:', sessionId);
        } catch (error) {
          console.error('Error initializing chat session:', error);
          addMessage('Sorry, I had trouble connecting to the server. Please try again later.', 'bot');
        }
      }
      
      // Load chat history if session exists
      async function loadChatHistory() {
        if (!sessionId) return;
        
        try {
          const response = await fetch(`${API_BASE_URL}/chat/history/${sessionId}`);
          
          if (!response.ok) {
            if (response.status === 404) {
              // Session expired or not found, create new session
              await initChatSession();
              return;
            }
            throw new Error('Failed to load chat history');
          }
          
          const data = await response.json();
          
          // Clear existing messages except the welcome message
          while (chatbotMessages.children.length > 1) {
            chatbotMessages.removeChild(chatbotMessages.lastChild);
          }
          
          // Add messages from history
          data.chat_history.forEach(item => {
            addMessage(item.query, 'user');
            addMessage(item.response, 'bot');
          });
        } catch (error) {
          console.error('Error loading chat history:', error);
        }
      }
      
      // Toggle chatbot interface
      chatbotIcon.addEventListener('click', function() {
        if (chatbotInterface.style.display === 'flex') {
          chatbotInterface.style.display = 'none';
        } else {
          chatbotInterface.style.display = 'flex';
          // Hide notification badge when chat is opened
          notificationBadge.style.display = 'none';
          // Focus on input
          userInput.focus();
          
          // Initialize session if it doesn't exist
          if (!sessionId) {
            initChatSession();
          } else {
            loadChatHistory();
          }
        }
      });
      
      // Close chatbot
      closeChatbot.addEventListener('click', function() {
        chatbotInterface.style.display = 'none';
      });
      
      // Toggle fullscreen mode
      fullscreenButton.addEventListener('click', function() {
        chatbotInterface.classList.toggle('fullscreen');
        
        // Change fullscreen button icon based on state
        if (chatbotInterface.classList.contains('fullscreen')) {
          fullscreenButton.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path>
            </svg>
          `;
        } else {
          fullscreenButton.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
            </svg>
          `;
        }
        
        // Scroll to bottom of messages
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
      });
      
      // Send message function
      async function sendUserMessage() {
        const message = userInput.value.trim();
        if (message === '') return;
        
        // Add user message to chat
        addMessage(message, 'user');
        
        // Clear input
        userInput.value = '';
        
        // Show loading indicator
        chatbotLoading.style.display = 'block';
        
        try {
          // Initialize session if it doesn't exist
          if (!sessionId) {
            await initChatSession();
          }
          
          // Send message to backend
          const response = await fetch(`${API_BASE_URL}/chat`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              query: message,
              session_id: sessionId
            })
          });
          
          if (!response.ok) {
            throw new Error('Failed to get response from server');
          }
          
          const data = await response.json();
          
          // Hide loading indicator
          chatbotLoading.style.display = 'none';
          
          // Add bot response to chat
          addMessage(data.response, 'bot');
        } catch (error) {
          console.error('Error sending message:', error);
          
          // Hide loading indicator
          chatbotLoading.style.display = 'none';
          
          // Add error message
          addMessage('Sorry, I experienced a technical issue. Please try again later.', 'bot');
        }
      }
      
      // Send message on button click
      sendMessage.addEventListener('click', sendUserMessage);
      
      // Send message on Enter key
      userInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          sendUserMessage();
        }
      });
      
      function addMessage(message, sender) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('message');
      
        const contentDiv = document.createElement('div');
        contentDiv.classList.add('message-content');
      
        const paragraph = document.createElement('p');
      
        // Parse basic markdown manually:
        let formattedMessage = message
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')    // Bold **text**
          .replace(/_(.*?)_/g, '<em>$1</em>')                  // Italic _text_
          .replace(/`(.*?)`/g, '<code>$1</code>')              // Inline code `text`
          .replace(/\n/g, '<br>')                              // New lines
          .replace(/^\s*\*\s(.*)$/gm, '<li>$1</li>')            // Bulleted list items
          .replace(/^\s*\d+\.\s(.*)$/gm, '<li>$1</li>');        // Numbered list items
      
        // Wrap <li> elements inside <ul> or <ol> appropriately
        if (formattedMessage.includes('<li>')) {
          // Check if original message had numbered list or bullet list
          if (/^\s*\d+\.\s/m.test(message)) {
            formattedMessage = `<ol>${formattedMessage}</ol>`;  // Ordered list for numbers
          } else {
            formattedMessage = `<ul>${formattedMessage}</ul>`;  // Unordered list for bullets
          }
        }
      
        paragraph.innerHTML = formattedMessage;
      
        contentDiv.appendChild(paragraph);
      
        const timeDiv = document.createElement('div');
        timeDiv.classList.add('message-time');
        timeDiv.textContent = getCurrentTime();
      
        if (sender === 'user') {
          messageElement.classList.add('user-message');
        } else {
          messageElement.classList.add('bot-message');
        }
      
        messageElement.appendChild(contentDiv);
        messageElement.appendChild(timeDiv);
      
        chatbotMessages.appendChild(messageElement);
      
        // Scroll to the bottom
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
      }
      
      
      // Get current time in HH:MM format
      function getCurrentTime() {
        const now = new Date();
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        return `${hours}:${minutes}`;
      }
      
      // Setup manual resize functionality
      function setupResizeHandlers() {
        const resizeHandles = document.querySelectorAll('.resize-handle');
        
        resizeHandles.forEach(handle => {
          handle.addEventListener('mousedown', initResize);
        });
        
        function initResize(e) {
          e.preventDefault();
          
          // Prevent resizing in fullscreen mode
          if (chatbotInterface.classList.contains('fullscreen')) {
            return;
          }
          
          const resizeType = e.target.className.split(' ')[1]; // Get the resize handle class (e.g., resize-handle-se)
          const startX = e.clientX;
          const startY = e.clientY;
          const startWidth = parseInt(document.defaultView.getComputedStyle(chatbotInterface).width, 10);
          const startHeight = parseInt(document.defaultView.getComputedStyle(chatbotInterface).height, 10);
          const startTop = chatbotInterface.getBoundingClientRect().top;
          const startLeft = chatbotInterface.getBoundingClientRect().left;
          
          document.documentElement.addEventListener('mousemove', doResize);
          document.documentElement.addEventListener('mouseup', stopResize);
          
          function doResize(e) {
            let newWidth, newHeight;
            
            // Calculate new dimensions based on resize handle type
            switch(resizeType) {
              case 'resize-handle-se':
                newWidth = startWidth + (e.clientX - startX);
                newHeight = startHeight + (e.clientY - startY);
                break;
              case 'resize-handle-sw':
                newWidth = startWidth - (e.clientX - startX);
                newHeight = startHeight + (e.clientY - startY);
                chatbotInterface.style.left = (startLeft + (e.clientX - startX)) + 'px';
                break;
              case 'resize-handle-ne':
                newWidth = startWidth + (e.clientX - startX);
                newHeight = startHeight - (e.clientY - startY);
                chatbotInterface.style.top = (startTop + (e.clientY - startY)) + 'px';
                break;
              case 'resize-handle-nw':
                newWidth = startWidth - (e.clientX - startX);
                newHeight = startHeight - (e.clientY - startY);
                chatbotInterface.style.top = (startTop + (e.clientY - startY)) + 'px';
                chatbotInterface.style.left = (startLeft + (e.clientX - startX)) + 'px';
                break;
            }
            
            // Apply min/max constraints
            const minWidth = 300;
            const minHeight = 400;
            const maxWidth = window.innerWidth * 0.9;
            const maxHeight = window.innerHeight * 0.9;
            
            newWidth = Math.max(minWidth, Math.min(newWidth, maxWidth));
            newHeight = Math.max(minHeight, Math.min(newHeight, maxHeight));
            
            // Apply new dimensions
            chatbotInterface.style.width = newWidth + 'px';
            chatbotInterface.style.height = newHeight + 'px';
            
            // Scroll to bottom of messages
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
          }
          
          function stopResize() {
            document.documentElement.removeEventListener('mousemove', doResize);
            document.documentElement.removeEventListener('mouseup', stopResize);
          }
        }
      }
      
      // Initialize resize handlers
      setupResizeHandlers();
      
      // Setup fallback logic in case backend is unavailable
      function setupFallbackMode() {
        // Define simple fallback responses
        const fallbackResponses = {
          'hello': 'Hello! How can I help you with SBI Fraud Detection today?',
          'hi': 'Hi there! How can I assist you with fraud detection?',
          'help': 'I can help you understand SBI\'s fraud detection services, explain how to report suspicious activities, or provide general information about our security features.',
          'fraud': 'SBI\'s fraud detection system uses advanced AI to identify suspicious patterns and activities. We monitor transactions 24/7 to keep your accounts safe.',
          'contact': 'You can reach our support team at support@sbifraud.com or call our hotline at 1-800-SBI-HELP.',
          'report': 'To report suspicious activity, please use the \'Manual Data Entry\' feature in the Detection menu or contact our 24/7 fraud reporting line.',
          'thank': 'You\'re welcome! Is there anything else I can help you with?',
          'bye': 'Thank you for chatting with SBI Fraud Detection Assistant. Have a great day!'
        };
        
        // Fallback send message function when backend is unavailable
        async function fallbackSendMessage() {
          const message = userInput.value.trim();
          if (message === '') return;
          
          // Add user message to chat
          addMessage(message, 'user');
          
          // Clear input
          userInput.value = '';
          
          // Show loading indicator
          chatbotLoading.style.display = 'block';
          
          // Simulate processing delay
          setTimeout(() => {
            // Hide loading indicator
            chatbotLoading.style.display = 'none';
            
            // Generate fallback response
            let botResponse = 'I\'m currently operating in offline mode. Please try again later when our servers are available.';
            
            // Check for keyword matches
            const messageLower = message.toLowerCase();
            for (const [keyword, response] of Object.entries(fallbackResponses)) {
              if (messageLower.includes(keyword)) {
                botResponse = response;
                break;
              }
            }
            
            // Add bot response to chat
            addMessage(botResponse, 'bot');
          }, 1000);
        }
        
        // Test backend connection
        fetch(`${API_BASE_URL}/chat/start`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Backend unavailable');
          }
          // Backend is available, use normal functionality
          return response.json();
        })
        .then(data => {
          sessionId = data.session_id;
          console.log('Chat session initialized with ID:', sessionId);
        })
        .catch(error => {
          console.warn('Backend unavailable, switching to fallback mode:', error);
          // Override the sendUserMessage function with fallback version
          window.sendUserMessage = fallbackSendMessage;
          
         // Replace event listeners
         sendMessage.removeEventListener('click', sendUserMessage);
         sendMessage.addEventListener('click', fallbackSendMessage);
         
         userInput.removeEventListener('keypress', function(e) {
           if (e.key === 'Enter') sendUserMessage();
         });
         
         userInput.addEventListener('keypress', function(e) {
           if (e.key === 'Enter') fallbackSendMessage();
         });
         
         // Add a message to inform user
         setTimeout(() => {
           addMessage('I\'m currently in offline mode. Some features may be limited.', 'bot');
         }, 1000);
       });
     }
     
     // Check for backend availability when page loads
     setupFallbackMode();
     
     // Make chatbot draggable when not in fullscreen mode
     function makeDraggable() {
       let isDragging = false;
       let offsetX, offsetY;
       
       // Only allow dragging by the header
       const chatbotHeader = chatbotInterface.querySelector('.chatbot-header');
       
       chatbotHeader.addEventListener('mousedown', startDrag);
       
       function startDrag(e) {
         // Don't drag in fullscreen mode
         if (chatbotInterface.classList.contains('fullscreen')) {
           return;
         }
         
         // Ignore if clicking on buttons
         if (e.target.closest('button')) {
           return;
         }
         
         e.preventDefault();
         
         // Get the initial mouse position and chatbot position
         isDragging = true;
         offsetX = e.clientX - chatbotInterface.getBoundingClientRect().left;
         offsetY = e.clientY - chatbotInterface.getBoundingClientRect().top;
         
         document.addEventListener('mousemove', doDrag);
         document.addEventListener('mouseup', stopDrag);
         
         // Add a dragging class for visual feedback
         chatbotInterface.classList.add('dragging');
       }
       
       function doDrag(e) {
         if (!isDragging) return;
         
         // Calculate new position
         const x = e.clientX - offsetX;
         const y = e.clientY - offsetY;
         
         // Apply constraints to keep within window
         const maxX = window.innerWidth - chatbotInterface.offsetWidth;
         const maxY = window.innerHeight - chatbotInterface.offsetHeight;
         
         const boundedX = Math.max(0, Math.min(x, maxX));
         const boundedY = Math.max(0, Math.min(y, maxY));
         
         // Update position
         chatbotInterface.style.left = boundedX + 'px';
         chatbotInterface.style.top = boundedY + 'px';
         chatbotInterface.style.right = 'auto';
         chatbotInterface.style.bottom = 'auto';
       }
       
       function stopDrag() {
         isDragging = false;
         document.removeEventListener('mousemove', doDrag);
         document.removeEventListener('mouseup', stopDrag);
         chatbotInterface.classList.remove('dragging');
       }
     }
     
     // Initialize draggable functionality
     makeDraggable();
   });
  </script> 
  <!-- SBI Chatbot Widget - Add this before closing body tag -->
<div id="sbi-chatbot-widget">
  <div class="chat-icon" id="chat-icon">
    <i class="fa fa-comments"></i>
  </div>
  
  <div class="chat-container" id="chat-container">
    <div class="chat-header">
      <div class="chat-header-title">
        <img src="sbi_logo.png" alt="SBI Logo" class="chat-logo">
        <span>SBI Assistant</span>
      </div>
      <div class="chat-header-options">
        <i class="fa fa-minus minimize-chat"></i>
        <i class="fa fa-times close-chat"></i>
      </div>
    </div>
    
    <div class="chat-body" id="chat-body">
      <div class="chat-message bot-message">
        <div class="message-content">
          <p>Hello! I'm your SBI Assistant. How can I help you today?</p>
        </div>
        <div class="message-time">Just now</div>
      </div>
    </div>
    
    <div class="chat-input">
      <input type="text" id="user-input" placeholder="Type your message here...">
      <button id="send-button"><i class="fa fa-paper-plane"></i></button>
    </div>
  </div>
</div>

<!-- Add this before closing body tag - Include Font Awesome if not already in your page -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
  #sbi-chatbot-widget {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    font-family: Arial, sans-serif;
  }
  
  .chat-icon {
    background-color: #2d4d9e; /* SBI Blue */
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    font-size: 24px;
  }
  
  .chat-icon:hover {
    background-color: #3a63c9;
  }
  
  .chat-container {
    position: absolute;
    bottom: 80px;
    right: 0;
    width: 350px;
    height: 500px;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
    display: none;
    flex-direction: column;
    overflow: hidden;
  }
  
  .chat-header {
    background-color: #2d4d9e; /* SBI Blue */
    color: white;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .chat-header-title {
    display: flex;
    align-items: center;
  }
  
  .chat-logo {
    height: 20px;
    margin-right: 10px;
  }
  
  .chat-header-options i {
    margin-left: 15px;
    cursor: pointer;
  }
  
  .chat-header-options i:hover {
    opacity: 0.8;
  }
  
  .chat-body {
    flex: 1;
    padding: 15px;
    overflow-y: auto;
    background-color: #f5f5f5;
  }
  
  .chat-message {
    margin-bottom: 15px;
    display: flex;
    flex-direction: column;
    max-width: 80%;
  }
  
  .bot-message {
    align-items: flex-start;
  }
  
  .user-message {
    align-items: flex-end;
    align-self: flex-end;
  }
  
  .message-content {
    padding: 10px 15px;
    border-radius: 15px;
  }
  
  .bot-message .message-content {
    background-color: white;
    border: 1px solid #e0e0e0;
    border-bottom-left-radius: 5px;
  }
  
  .user-message .message-content {
    background-color: #2d4d9e; /* SBI Blue */
    color: white;
    border-bottom-right-radius: 5px;
  }
  
  .message-time {
    font-size: 11px;
    color: #888;
    margin-top: 5px;
    padding: 0 5px;
  }
  
  .typing-indicator {
    display: flex;
    padding: 10px 15px;
    background-color: white;
    border-radius: 15px;
    border-bottom-left-radius: 5px;
    border: 1px solid #e0e0e0;
    margin-bottom: 15px;
    align-items: center;
  }
  
  .typing-indicator span {
    height: 8px;
    width: 8px;
    background-color: #888;
    border-radius: 50%;
    display: inline-block;
    margin-right: 5px;
    animation: blink 1.4s infinite both;
  }
  
  .typing-indicator span:nth-child(2) {
    animation-delay: 0.2s;
  }
  
  .typing-indicator span:nth-child(3) {
    animation-delay: 0.4s;
  }
  
  @keyframes blink {
    0% {
      opacity: 0.1;
    }
    20% {
      opacity: 1;
    }
    100% {
      opacity: 0.1;
    }
  }
  
  .chat-input {
    display: flex;
    padding: 15px;
    background-color: white;
    border-top: 1px solid #eee;
  }
  
  .chat-input input {
    flex: 1;
    padding: 10px 15px;
    border: 1px solid #ddd;
    border-radius: 20px;
    outline: none;
  }
  
  .chat-input input:focus {
    border-color: #2d4d9e;
  }
  
  .chat-input button {
    background-color: #2d4d9e; /* SBI Blue */
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-left: 10px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .chat-input button:hover {
    background-color: #3a63c9;
  }
  
  .chat-input button:disabled {
    background-color: #bbb;
    cursor: not-allowed;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const chatIcon = document.getElementById('chat-icon');
    const chatContainer = document.getElementById('chat-container');
    const chatBody = document.getElementById('chat-body');
    const userInput = document.getElementById('user-input');
    const sendButton = document.getElementById('send-button');
    const minimizeChat = document.querySelector('.minimize-chat');
    const closeChat = document.querySelector('.close-chat');
    
    let sessionId = null;
    const apiUrl = 'http://192.168.57.211:5000'; // Update this to your API URL

    // Toggle chat window
    chatIcon.addEventListener('click', function() {
      chatContainer.style.display = chatContainer.style.display === 'flex' ? 'none' : 'flex';
      
      if (chatContainer.style.display === 'flex' && !sessionId) {
        // Start a new chat session when opening chat for first time
        startChatSession();
      }
    });
    
    // Minimize chat
    minimizeChat.addEventListener('click', function() {
      chatContainer.style.display = 'none';
    });
    
    // Close chat
    closeChat.addEventListener('click', function() {
      chatContainer.style.display = 'none';
      // Optionally reset session if you want to start fresh on reopen
      // sessionId = null;
    });
    
    // Send message on button click
    sendButton.addEventListener('click', sendMessage);
    
    // Send message on Enter key
    userInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });
    
    // Start chat session
    function startChatSession() {
      fetch(`${apiUrl}/chat/start`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => response.json())
      .then(data => {
        sessionId = data.session_id;
        console.log('Chat session started:', sessionId);
      })
      .catch(error => {
        console.error('Error starting chat session:', error);
        addMessage('Sorry, I\'m having trouble connecting to the server. Please try again later.', 'bot');
      });
    }
    
    // Send message function
    function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;
      
      // Clear input
      userInput.value = '';
      
      // Add user message to chat
      addMessage(message, 'user');
      
      // Show typing indicator
      showTypingIndicator();
      
      // Ensure we have a session
      if (!sessionId) {
        startChatSession().then(() => sendMessageToAPI(message));
      } else {
        sendMessageToAPI(message);
      }
    }
    
    // Send message to API
    function sendMessageToAPI(message) {
      fetch(`${apiUrl}/chat`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          query: message,
          session_id: sessionId
        })
      })
      .then(response => response.json())
      .then(data => {
        // Remove typing indicator
        removeTypingIndicator();
        
        // Add bot response
        if (data.response) {
          addMessage(data.response, 'bot');
        } else if (data.error) {
          addMessage('Sorry, there was an error: ' + data.error, 'bot');
        }
        
        // Update session ID if provided
        if (data.session_id) {
          sessionId = data.session_id;
        }
      })
      .catch(error => {
        console.error('Error sending message:', error);
        removeTypingIndicator();
        addMessage('Sorry, I\'m having trouble connecting to the server. Please try again later.', 'bot');
      });
    }
    
    // Add message to chat
    function addMessage(message, type) {
      const messageElement = document.createElement('div');
      messageElement.className = `chat-message ${type}-message`;
      
      const messageContent = document.createElement('div');
      messageContent.className = 'message-content';
      
      // Handle multi-line messages
      message.split('\n').forEach(line => {
        if (line.trim() !== '') {
          const paragraph = document.createElement('p');
          paragraph.textContent = line;
          messageContent.appendChild(paragraph);
        }
      });
      
      const messageTime = document.createElement('div');
      messageTime.className = 'message-time';
      messageTime.textContent = 'Just now';
      
      messageElement.appendChild(messageContent);
      messageElement.appendChild(messageTime);
      
      chatBody.appendChild(messageElement);
      
      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }
    
    // Show typing indicator
    function showTypingIndicator() {
      const indicator = document.createElement('div');
      indicator.className = 'typing-indicator';
      indicator.id = 'typing-indicator';
      
      for (let i = 0; i < 3; i++) {
        const dot = document.createElement('span');
        indicator.appendChild(dot);
      }
      
      chatBody.appendChild(indicator);
      chatBody.scrollTop = chatBody.scrollHeight;
    }
    
    // Remove typing indicator
    function removeTypingIndicator() {
      const indicator = document.getElementById('typing-indicator');
      if (indicator) {
        indicator.remove();
      }
    }
  });
</script>
</body> 